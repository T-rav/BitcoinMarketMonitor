<!doctype html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="An application to monitor BTC exchanges around the world.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Crypto Market Monitor</title>

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Web Starter Kit">
    <link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
    <link rel="canonical" href="http://www.example.com/">
    -->

    <!-- Page styles -->
    <!--<link rel="stylesheet" href="styles/main.css">-->
	<link href="styles/bootstrap.min.css" rel="stylesheet">
	
  </head>
  <body>
  
	<div id="load" class=" main-container collapse">
		<span style="position:fixed;top:40%;left:20%;">
			<h2>Crypto<strong><br/>Markets Monitor</strong></h2>
			<h5>StoneAge Technologies</h5>
		</span>
		<div id="messageRegion" class="alert alert-dismissable alert-info top">
			<span data-bind="text: message"></span>
		</div>
		<!-- Ad unit ID : ca-app-pub-7845656758279006/9684182374 -->
		<div id="progressRegion" class="progress progress-striped active middle">
	       <div class="progress-bar" style="width: 2%"></div>
	    </div>
	</div>
  
   <!-- class="collapse" -->
	<div id="main" class="collapse">
		<header class="app-bar promote-layer">
		  <div class="app-bar-container">
			<span style="margin-left:-2px;">
				<h2 class="logo">Crypto<strong>Markets</strong></h2>
			</span>
			<span style="float:right;">
				<button style="width:25px;" data-bind="click: displayAbout"><img src="images/info.svg""></button>
				<button style="width:35px; margin-right:10px;" class="menu"><img src="images/hamburger.svg" alt="Menu"></button>
			</span>
			<section class="app-bar-actions">
			</section>
		  </div>
		</header>
		
		<div class="navdrawer-container promote-layer navbar navbar-inverse">
		  <div class="navbar-header">
			<h4 class="navbar-brand" data-toggle="collapse" data-target="#settingsMenu"><b>Settings</b>&nbsp;<span class="badge">1</span></h4>
		  </div>
		  <div id="settingsMenu" class="navbar-collapse collapse">
			<form>
				<ul class="nav navbar-nav">
				  <li class="smallListMenuItem"><a href='#/settings/defaults' data-toggle="collapse" data-target="#defaults">Defaults</a></li>
				  <!--<li class="smallListMenuItem"><a href='#/settings/notifications' data-toggle="collapse" data-target="#notification">Notifications</a></li>-->
				</ul>
			</form>
		  </div>
		  
		  <!-- Currencies Section -->
		  <div class="navbar-header">
			<h4 class="navbar-brand" data-toggle="collapse" data-target="#currencyMenu"><b>Currencies</b> <span class="badge" data-bind="text: fiatCurrency().length"></span></h4>
		  </div>
		  <div id="currencyMenu" class="navbar-collapse collapse">
			<!--<h5 data-toggle="collapse" data-target="#btc"><b>BTC</b> <span class="badge" data-bind="text: fiatCurrency().length"></span></h5>-->
			<ul id="btc" class="nav navbar-nav" data-bind="foreach:fiatCurrency()">
			  <!-- data-bind="attr: { href: url }" -->
			  <li class="listMenuItem"><a href='#' data-bind="text: name,click: $parent.setData"></a></li>
			</ul>
			<!--<h5 id="ltc"><b>LTC</b> <span class="badge" data-bind="text: fiatCurrency().length"></span></h5>-->
		  </div>
		</div>
		
		<main class="main-container">
			<div class="headerWrapper">
				<div style="margin-left:5px;"><b>Currency</b> : <span data-bind="text: currency"></span> &nbsp;<span class="badge" data-bind="text: exchangeState().length"></span></div>
				<table class="table table-striped" style="font-size:13px;">
					<thead>
						<tr class="tableRow" data-bind="foreach: headers">
							<td style="font-weight:bold;" data-bind="click: $parent.sort, text: title"></td>
						</tr>
					</thead>	
				</table>
			</div>
			<div class="tableWrapper">
				<table class="table table-striped tableContainer">
					<tbody data-bind="foreach:exchangeState">
						<tr>
							<td class="tableCell" data-bind="text: symbol, click: $parent.marketView"> </td>
							<td class="tableCell" data-bind="text: close"> </td>
							<td class="tableCell" data-bind="text: lastTradeMinutes"> </td>
							<td class="tableCell" data-bind="text: avg"> </td>
							<td class="tableCell" data-bind="text: volume"> </td>
						</tr>
					</tbody>
				</table>
			</div>
			<div class="lastSync"> Last Sync : <span data-bind="text: lastSync"></span></div>
		</main>

		<!-- Message Banners -->
		<div  id="error" class="alert alert-dismissable alert-danger footer">
		  <strong>Oh snap!</strong> <span>An error occurred syncing.</span><br/><span> Please ensure your wifi or mobile data is on.</span>
		</div>
		<div  id="info" class="alert alert-dismissable alert-info footer">
		  <strong>Hello.</strong> <span>This application monitors Bitcoin exchanges around the world trading in a variety of currencies and displays key trade info about each.</span>
		</div>
	</div>
	
	<!-- Market View -->
	<div id="market" class="settings-container collapse">
		<header class="app-bar promote-layer" style="margin-left:10px;">
			<h4>Exchange: <strong data-bind="text: symbol"></strong></h4>
			<hr/>
		</header>
		<div style="margin-left:10px;">
			<div class="marketLeft">
				Currency: <strong><span data-bind="text: currency"></span></strong>
			</div>
			<div class="marketRight">
				Volume: <span data-bind="text: volume"></span>
			</div>
			<div class="marketLeft">
				High: <span data-bind="text: high"></span>
			</div>
			<div class="marketRight">
				Low: <span data-bind="text: low"></span>
			</div>
			<div class="marketLeft">
				Average: <span data-bind="text: avg"></span>
			</div>
			<div class="marketRight">
				Close: <span data-bind="text: close"></span>
			</div>
			<div class="marketLeft">
				Ask: <span data-bind="text: ask"></span>
			</div>
			<div class="marketRight">
				Bid: <span data-bind="text: bid"></span>
			</div>
			<div class="marketLeft">
				Last Trade: <span data-bind="text: lastTradeTime"></span>
			</div>
			<!--
			<div class="marketRight"> 
				Trend:
			</div>
			<div>
				Graphs to go here ;)
			</div-->
			<div  class="form-group" style="margin-top:15px;">
			  <div class="col-lg-10 col-lg-offset-2">
				<button type="submit" class="btn btn-primary" style="float:right;" data-bind="click: closeMarketView">Ok</button>
			  </div>
			</div>
		</div>
	</div>
	
	<!-- Default View -->
	<!-- TODO : Build defaults model, use knockout to bind options in drop down -->
	<div id="defaults" class="settings-container collapse">
		<header class="app-bar promote-layer" style="margin-left:5px;">
			<h4><strong>Defaults</strong></h4>
			<hr/>
		</header>
		<form class="form-horizontal main-container">
			<fieldset>
				<div class="form-group">
				  <label for="select" class="col-lg-2 control-label" style="margin-left:5px;">Currencies</label> <span class="badge" data-bind="click: toggleLoadCurrency, css: { selectedBadge: isDefaultSelected, deselectedBadge: !isDefaultSelected }">Set Default</span>
				  <div id="mainDefaults" class="col-lg-10" style="margin-bottom:3px;" data-bind="foreach: fiatCurrency">
					<span class="badge" style="width:45px; line-height:25px; margin-bottom:5px; margin-left:5px;" data-bind="text: name,click: $parent.toggle, css: { selectedBadge: selected, deselectedBadge: !selected }"></span>
				  </div>
				  <div id="loadDefaults" class="col-lg-10 collapse" style="margin-bottom:3px;" data-bind="foreach: defaultFiatCurrency">
					<span class="badge deselectedBadge" style="width:45px; line-height:25px; margin-bottom:5px; margin-left:5px;" data-bind="text: name, click: $parent.toggleDefault, css: { selectedBadge: selected, deselectedBadge: !selected }"></span>
				  </div>
				</div>
				<div  class="form-group" style="margin-top:15px;">
				  <div class="col-lg-10 col-lg-offset-2">
					<button class="btn btn-default" style="float:left;" data-bind="click: cancel" data-toggle="collapse" data-target="#defaults">Cancel</button>
					<button type="submit" class="btn btn-primary" style="float:right;" data-bind="click: save" data-toggle="collapse" data-target="#defaults">Save</button>
				  </div>
				</div>
		    </fieldset>
		</form>
    </div>
	<!--
	<div id="notification" class="settings-container collapse">
		<header class="app-bar promote-layer" style="margin-left:5px;">
			<h4><strong>Notifications</strong></h4>
			<hr/>
		</header>
		<form class="form-horizontal main-container">
			<fieldset>
				<div class="form-group">
				  <div class="col-lg-10 col-lg-offset-2">
					<button class="btn btn-default" style="float:left;" data-toggle="collapse" data-target="#notification">Cancel</button>
					<button type="submit" class="btn btn-primary" style="float:right;" data-toggle="collapse" data-target="#notification">Save</button>
				  </div>
				</div>
		    </fieldset>
		</form>
    </div>
	-->
	
	<script src="scripts/001_WebHelper.js"></script>
	<script src="scripts/002_PrefsHelper.js"></script>
	<script src="scripts/998_app.js"></script>
	<script src="scripts/999_main.js"></script>
	<script src="cordova.js"></script>
	<script src="libs/jquery.js"></script>
	<script src="libs/knockout.js"></script>
	<script src="libs/bootstrap.min.js"></script>
    <script src="libs/docs.min.js"></script>
	<script src="scripts/viewModel.js"></script>
	<script src="scripts/loadViewModel.js"></script>
	
	<script type="text/javascript">
	
		var prefs = window.PrefsHelper;
		var noop = function() {};
		var viewService = new ViewService();
		var settingsViewModel = new SettingsViewModel();
		var marketViewModel = new MarketViewModel();
		
		var viewModel = new ViewModel(viewService, settingsViewModel, marketViewModel);
		var message = new MessageModel();
		var model = new UpdateProgress(10, 8);
		
		$(function() {
				// -- load
				setInterval(function(){model.update(message);}, 400);
				ko.applyBindings(message, document.getElementById("load"));
		
				// settings
				ko.applyBindings(settingsViewModel, document.getElementById("defaults"));
		
				// -- main
				viewModel.currency("USD"); // Text appears
				ko.applyBindings(viewModel, document.getElementById("main"));
				viewService.init(viewModel, settingsViewModel);
				viewModel.init();
				
				// -- market 
				ko.applyBindings(marketViewModel, document.getElementById("market"));
		});
		
	</script>
    <!-- endbuild -->
  </body>
</html>
